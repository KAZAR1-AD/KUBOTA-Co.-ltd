<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>お店検索（FIN006）</title>
    <link rel="stylesheet" href="../CSS/style.css">
</head>
<body class="fin006">
    
    <div class="container fin006-container"> 
        
        <div class="fin006-title-bar">
            <h2>どんなお店をお探しですか？</h2>
            <span class="header-icon-area" id="headerIconArea">
                </span>
        </div>

        <div class="fin006-search-box">
            <div class="fin006-criteria-row">
                <label for="budgetSlider" class="fin006-label">1人当たりの予算</label>
                <div class="fin006-input-area">
                    <input type="range" id="budgetSlider" class="fin006-slider" min="1000" max="20000" step="1000" value="10000">
                    <span id="budgetValue" class="fin006-value-display">10000円</span>
                </div>
            </div>
            <div class="fin006-criteria-row">
                <label for="distance" class="fin006-label">距離</label>
                <div class="fin006-input-area">
                    <select id="distance" class="fin006-select">
                        <option value="1">指定なし</option>
                        <option value="2">500m以内</option>
                        <option value="3">1km以内</option>
                        <option value="4">3km以内</option>
                    </select>
                </div>
            </div>
            <div class="fin006-criteria-row">
                <span class="fin006-label">ジャンル</span>
                <div class="fin006-input-area fin006-checkbox-group">
                    <label><input type="checkbox" name="genre" value="jp"> 和食</label>
                    <label><input type="checkbox" name="genre" value="we"> 洋食</label>
                    <label><input type="checkbox" name="genre" value="cn"> 中華</label>
                    <label><input type="checkbox" name="genre" value="ot"> その他</label>
                </div>
            </div>
        </div>
        
        <div class="button-area button-area-center">
            <button class="btn btn-primary fin006-btn" onclick="location.href='FIN007.html'">
                検索
            </button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            
            // --- スライダー処理 ---
            const budgetSlider = document.getElementById('budgetSlider');
            const budgetValue = document.getElementById('budgetValue');
            if (budgetSlider && budgetValue) {
                budgetSlider.addEventListener('input', function() {
                    budgetValue.textContent = this.value + '円';
                });
                budgetValue.textContent = budgetSlider.value + '円';
            }

            // --- ログイン状態チェック処理 ---
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const savedImageUrl = localStorage.getItem('profileImage');
            const iconArea = document.getElementById('headerIconArea');

            if (!iconArea) return; // エラー防止

            if (isLoggedIn === 'true') {
                let imageUrlToShow = savedImageUrl ? savedImageUrl : '../images/icon_default.png';

                // ★ 変更点：クラス名を .header-profile-icon に統一
                iconArea.innerHTML = `
                    <a href="FIN008.html" class="header-profile-icon"> 
                        <img src="${imageUrlToShow}" alt="メニュー">
                    </a>`;
            } else {
                iconArea.innerHTML = '<a href="FIN002.html" class="btn btn-secondary header-login-btn">ログイン</a>';
                
                const loginBtn = iconArea.querySelector('.header-login-btn');
                if (loginBtn) {
                    loginBtn.addEventListener('click', function(e) {
                        e.preventDefault(); 
                        const currentUrl = window.location.href;
                        localStorage.setItem('redirectUrl', currentUrl); 
                        localStorage.setItem('loginRedirect', currentUrl); 
                        window.location.href = e.target.href; 
                    });
                }
            }
        });
    </script>

</body>
</html>